/*
 MIT
 @author Alexandre Thebaldi (ahlechandre@gmail.com).
 @link https://github.com/ahlechandre/mdl-stepper
*/
(function(){var d=function(a){this.element_=a;this.init()};window.MaterialStepper=d;d.prototype.Stepper_={};d.prototype.getStepper_=function(){return{isLinear:this.element_.classList.contains(this.CssClasses_.STEPPER_LINEAR),hasFeedback:this.element_.classList.contains(this.CssClasses_.STEPPER_FEEDBACK)}};d.prototype.StepState_={COMPLETED:"completed",ERROR:"error",NORMAL:"normal"};d.prototype.DatasetAttributes_={CONTINUE:"stepper-next",CANCEL:"stepper-cancel",SKIP:"stepper-skip",BACK:"stepper-back"};
d.prototype.CustomEvents_={onstepnext:new CustomEvent("onstepnext",{bubbles:!0,cancelable:!0}),onstepcancel:new CustomEvent("onstepcancel",{bubbles:!0,cancelable:!0}),onstepskip:new CustomEvent("onstepskip",{bubbles:!0,cancelable:!0}),onstepback:new CustomEvent("onstepback",{bubbles:!0,cancelable:!0}),onstepcomplete:new CustomEvent("onstepcomplete",{bubbles:!0,cancelable:!0}),onsteperror:new CustomEvent("onsteperror",{bubbles:!0,cancelable:!0}),onsteppercomplete:new CustomEvent("onsteppercomplete",
{bubbles:!0,cancelable:!0})};d.prototype.CssClasses_={RIPPLE_EFFECT:"mdl-js-ripple-effect",BUTTON_JS:"mdl-js-button",STEPPER_LINEAR:"mdl-stepper--linear",STEPPER_FEEDBACK:"mdl-stepper--feedback",STEP_COMPLETED:"mdl-step--completed",STEP_ERROR:"mdl-step--error",STEP_TRANSIENT:"mdl-step--transient",STEP_OPTIONAL:"mdl-step--optional",STEP_EDITABLE:"mdl-step--editable",IS_ACTIVE:"is-active",TRANSIENT:"mdl-step__transient",TRANSIENT_OVERLAY:"mdl-step__transient-overlay",TRANSIENT_LOADER:"mdl-step__transient-loader",
SPINNER:"mdl-spinner",SPINNER_JS:"mdl-js-spinner",SPINNER_IS_ACTIVE:"is-active",STEPPER:"mdl-stepper",STEP:"mdl-step",STEP_LABEL:"mdl-step__label",STEP_LABEL_INDICATOR:"mdl-step__label-indicator",STEP_LABEL_INDICATOR_CONTENT:"mdl-step__label-indicator-content",STEP_TITLE:"mdl-step__title",STEP_TITLE_TEXT:"mdl-step__title-text",STEP_TITLE_MESSAGE:"mdl-step__title-message",STEP_CONTENT:"mdl-step__content",STEP_ACTIONS:"mdl-step__actions"};d.prototype.Steps_={};d.prototype.getIndicatorElement_=function(a){var c=
document.createElement("span");a=this.getIndicatorContentNormal_(a.label_indicator_text);c.classList.add(this.CssClasses_.STEP_LABEL_INDICATOR);c.appendChild(a);return c};d.prototype.getIndicatorContentNormal_=function(a){var c=document.createElement("span");c.classList.add(this.CssClasses_.STEP_LABEL_INDICATOR_CONTENT);c.textContent=a;return c};d.prototype.getIndicatorContentCompleted_=function(a){var c=document.createElement("i");c.classList.add("material-icons",this.CssClasses_.STEP_LABEL_INDICATOR_CONTENT);
c.textContent=a?"edit":"check";return c};d.prototype.getIndicatorContentError_=function(a){a=document.createElement("span");a.classList.add(this.CssClasses_.STEP_LABEL_INDICATOR_CONTENT);a.textContent="!";return a};d.prototype.getStepModel_=function(a,c){var b={};b.container=a;b.id=c;b.label=a.querySelector("."+this.CssClasses_.STEP_LABEL);b.label_indicator_text=c;b.label_title=a.querySelector("."+this.CssClasses_.STEP_TITLE);b.label_title_text=a.querySelector("."+this.CssClasses_.STEP_TITLE_TEXT).textContent;
b.label_title_message=a.querySelector("."+this.CssClasses_.STEP_TITLE_MESSAGE);b.label_title_message_text=b.label_title_message?b.label_title_message.textContent:"";b.content=a.querySelector("."+this.CssClasses_.STEP_CONTENT);b.actions=a.querySelector("."+this.CssClasses_.STEP_ACTIONS);b.actions_next=b.actions.querySelector("[data-"+this.DatasetAttributes_.CONTINUE+"]")||null;b.actions_cancel=b.actions.querySelector("[data-"+this.DatasetAttributes_.CANCEL+"]")||null;b.actions_skip=b.actions.querySelector("[data-"+
this.DatasetAttributes_.SKIP+"]")||null;b.actions_back=b.actions.querySelector("[data-"+this.DatasetAttributes_.BACK+"]")||null;b.label_indicator=b.label.querySelector("."+this.CssClasses_.STEP_LABEL_INDICATOR);b.label_indicator||(b.label_indicator=this.getIndicatorElement_(b),b.label.appendChild(b.label_indicator));b.state=a.classList.contains(this.CssClasses_.STEP_COMPLETED)?this.StepState_.COMPLETED:a.classList.contains(this.CssClasses_.STEP_ERROR)?this.StepState_.ERROR:this.StepState_.NORMAL;
b.isActive=a.classList.contains(this.CssClasses_.IS_ACTIVE);b.isOptional=a.classList.contains(this.CssClasses_.STEP_OPTIONAL);b.isEditable=a.classList.contains(this.CssClasses_.STEP_EDITABLE);return b};d.prototype.getActive=function(){return this.Steps_.collection[this.Steps_.active-1].container};d.prototype.getActiveId=function(){return this.Steps_.collection[this.Steps_.active-1].id};d.prototype.getSteps_=function(){for(var a=[],c=0,b=0,d=0,c=this.element_.querySelectorAll("."+this.CssClasses_.STEP),
e=0;e<c.length;e++)a[e]=this.getStepModel_(c[e],e+1),a[e].isOptional&&(b+=1),a[e].isActive&&(d=a[e].id);c=a.length;return{collection:a,total:c,completed:0,optional:b,active:d}};d.prototype.LabelRippleEffect_=function(a){var c=function(a,c,d){a.label.classList.add(this.CssClasses_.BUTTON_JS);a.label.classList.add(this.CssClasses_.RIPPLE_EFFECT)};a?c.bind(this)(a):this.Steps_.collection.forEach(c.bind(this));componentHandler.upgradeDom()};d.prototype.setStepActive_=function(a){if(this.hasTransient())return!1;
this.Steps_.collection.forEach(function(a,b,d){a.container.classList.remove(this.CssClasses_.IS_ACTIVE);a.isActive&&(a.isActive=!1)}.bind(this));a.container.classList.remove(this.CssClasses_.STEP_TRANSIENT);a.container.classList.add(this.CssClasses_.IS_ACTIVE);a.isActive=!0;this.Steps_.active=a.id;return!0};d.prototype.setActive_=function(a){if(!isNaN(a)&&(a>this.Steps_.total||0>=a))return!1;var c=!1;if(a)for(var b=0;b<this.Steps_.total;b++){var d=this.Steps_.collection[b];if(d.id===a){c=this.setStepActive_(d);
break}}else this.element_.querySelector("."+this.CssClasses_.IS_ACTIVE)||(c=this.setStepActive_(this.Steps_.collection[0]));this.Stepper_.isLinear&&this.updateLinearStates_();return c};d.prototype.updateStepState_=function(a,c){if(a.state===c)return!1;a.state===this.StepState_.COMPLETED&&--this.Steps_.completed;var b,d,e=a.label_indicator.querySelector("."+this.CssClasses_.STEP_LABEL_INDICATOR_CONTENT);switch(c){case this.StepState_.COMPLETED:this.Steps_.completed+=1;a.container.classList.remove(this.CssClasses_.STEP_ERROR);
d=this.getIndicatorContentCompleted_(a.isEditable);b=this.CssClasses_.STEP_COMPLETED;break;case this.StepState_.ERROR:a.container.classList.remove(this.CssClasses_.STEP_COMPLETED);d=this.getIndicatorContentError_();b=this.CssClasses_.STEP_ERROR;break;case this.StepState_.NORMAL:a.container.classList.remove(this.CssClasses_.STEP_COMPLETED),a.container.classList.remove(this.CssClasses_.STEP_ERROR),d=this.getIndicatorContentNormal_(a.label_indicator_text)}b&&a.container.classList.add(b);a.label_indicator.replaceChild(d,
e);a.state=c;b=!1;if(this.Steps_.completed===this.Steps_.total)b=!0;else if(this.Steps_.completed===this.Steps_.total-this.Steps_.optional){var f,g;for(g in this.Steps_.collection)if(f=this.Steps_.collection[g],f=!f.isOptional&&f.state!==this.StepState_.COMPLETED)break;b=!f}b&&this.dispatchEventOnStepperComplete_();return!0};d.prototype.updateLinearStates_=function(){for(var a=0;a<this.Steps_.total&&!this.Steps_.collection[a].isActive;a++)this.Steps_.collection[a].isOptional||this.updateStepState_(this.Steps_.collection[a],
this.StepState_.COMPLETED)};d.prototype.back=function(){var a=!1,c=function(a){var b=this.setActive_(a.id);b&&b&&this.Stepper_.hasFeedback&&this.removeTransientEffect_(a);return b},b;for(b in this.Steps_.collection){var d=this.Steps_.collection[b];if(d.isActive){b=this.Steps_.collection[d.id-2];if(!b)return!1;this.Stepper_.isLinear?b.isEditable&&(a=c.bind(this)(b)):a=c.bind(this)(b);break}}return a};d.prototype.skip=function(){var a=!1,c;for(c in this.Steps_.collection){var b=this.Steps_.collection[c];
if(b.isActive){b.isOptional&&(a=this.setActive_(b.id+1))&&this.Stepper_.hasFeedback&&this.removeTransientEffect_(b);break}}return a};d.prototype["goto"]=function(a){return this.setActive_(a)};d.prototype.error=function(a){for(var c in this.Steps_.collection){var b=this.Steps_.collection[c];if(b.isActive){this.Stepper_.hasFeedback&&this.removeTransientEffect_(b);this.updateStepState_(b,this.StepState_.ERROR);a&&this.updateTitleMessage_(b,a);this.dispatchEventOnStepError_(b);break}}};d.prototype.next=
function(){var a=!1,c;for(c in this.Steps_.collection){var b=this.Steps_.collection[c];if(b.isActive){a=b.id+1;this.Stepper_.hasFeedback&&this.removeTransientEffect_(b);b.state===this.StepState_.ERROR&&(b.label_title_message_text?this.updateTitleMessage_(b,b.label_title_message_text):this.removeTitleMessage_(b));if(b.isEditable&&this.Stepper_.isLinear)for(var d in this.Steps_.collection)if(c=this.Steps_.collection[d],c.id>b.id&&c.state!==this.StepState_.COMPLETED){a=c.id;break}a=this.setActive_(a);
this.Stepper_.isLinear?((b.isOptional||b.id===this.Steps_.total)&&this.updateStepState_(b,this.StepState_.COMPLETED),b.isEditable&&this.LabelRippleEffect_(b)):this.updateStepState_(b,this.StepState_.COMPLETED);this.dispatchEventOnStepComplete_(b);break}}return a};d.prototype.updateTitleMessage_=function(a,c){var b=a.label_title_message;b||(b=document.createElement("span"),b.classList.add(this.CssClasses_.STEP_TITLE_MESSAGE),a.label_title.appendChild(b));b.textContent=c};d.prototype.removeTitleMessage_=
function(a){(a=a.container.querySelector("."+this.CssClasses_.STEP_TITLE_MESSAGE))&&a.parentNode.removeChild(a)};d.prototype.removeTransientEffect_=function(a){var c=a.content.querySelector("."+this.CssClasses_.TRANSIENT);if(!c)return!1;a.container.classList.remove(this.CssClasses_.STEP_TRANSIENT);a.content.removeChild(c);return!0};d.prototype.addTransientEffect_=function(a){if(a.content.querySelector("."+this.CssClasses_.TRANSIENT))return!1;var c=document.createElement("div"),b=document.createElement("div"),
d=document.createElement("div"),e=document.createElement("div");c.classList.add(this.CssClasses_.TRANSIENT);b.classList.add(this.CssClasses_.TRANSIENT_OVERLAY);d.classList.add(this.CssClasses_.TRANSIENT_LOADER);e.classList.add(this.CssClasses_.SPINNER);e.classList.add(this.CssClasses_.SPINNER_JS);e.classList.add(this.CssClasses_.SPINNER_IS_ACTIVE);d.appendChild(e);c.appendChild(b);c.appendChild(d);a.container.classList.add(this.CssClasses_.STEP_TRANSIENT);a.content.appendChild(c);componentHandler.upgradeDom();
return!0};d.prototype.setCustomEvents_=function(){var a=function(a,c,d){a.isEditable&&a.label.addEventListener("click",function(c){c.preventDefault();a.state===this.StepState_.COMPLETED&&this.setStepActive_(a)}.bind(this))},c=function(a,c,d){a.label.addEventListener("click",function(c){c.preventDefault();this.setStepActive_(a)}.bind(this))};this.Stepper_.isLinear?this.Steps_.collection.forEach(a.bind(this)):this.Steps_.collection.forEach(c.bind(this));this.Steps_.collection.forEach(function(a,c,d){this.dispatchEventOnStepNext_(a);
this.dispatchEventOnStepCancel_(a);this.dispatchEventOnStepSkip_(a);this.dispatchEventOnStepBack_(a)}.bind(this))};d.prototype.dispatchEventOnStepComplete_=function(a){a.container.dispatchEvent(this.CustomEvents_.onstepcomplete)};d.prototype.dispatchEventOnStepError_=function(a){a.container.dispatchEvent(this.CustomEvents_.onsteperror)};d.prototype.dispatchEventOnStepperComplete_=function(){this.element_.dispatchEvent(this.CustomEvents_.onsteppercomplete)};d.prototype.dispatchEventOnStepNext_=function(a){if(!a.actions_next)return!1;
a.actions_next.addEventListener("click",function(c){c.preventDefault();this.Stepper_.hasFeedback&&this.addTransientEffect_(a);a.container.dispatchEvent(this.CustomEvents_.onstepnext)}.bind(this))};d.prototype.dispatchEventOnStepCancel_=function(a){if(!a.actions_cancel)return!1;a.actions_cancel.addEventListener("click",function(c){c.preventDefault();a.container.dispatchEvent(this.CustomEvents_.onstepcancel)}.bind(this))};d.prototype.dispatchEventOnStepSkip_=function(a){if(!a.actions_skip)return!1;
a.actions_skip.addEventListener("click",function(c){c.preventDefault();a.container.dispatchEvent(this.CustomEvents_.onstepskip)}.bind(this))};d.prototype.dispatchEventOnStepBack_=function(a){if(!a.actions_back)return!1;a.actions_back.addEventListener("click",function(c){c.preventDefault();a.container.dispatchEvent(this.CustomEvents_.onstepback)}.bind(this))};d.prototype.hasTransient=function(){return this.element_.querySelector("."+this.CssClasses_.STEP+" > "+("."+this.CssClasses_.STEP_CONTENT)+" > "+
("."+this.CssClasses_.TRANSIENT))?!0:!1};d.prototype.init=function(){this.element_&&(this.Stepper_=this.getStepper_(),this.Steps_=this.getSteps_(),this.Stepper_.isLinear||this.LabelRippleEffect_(),this.setActive_(),this.setCustomEvents_())};componentHandler.register({constructor:d,classAsString:"MaterialStepper",cssClass:"mdl-stepper",widget:!0})})();